"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[818],{30818:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g});var i=n(37876),r=n(14232),s=n(77232);let o=s.Ay.div.withConfig({componentId:"sc-f73b169e-0"})(["height:",";width:100%;"],({theme:e})=>`calc(100% - ${e.sizes.titleBar.height}px)`);var a=n(68667),l=n(81855),c=n(55295),d=n(16361),u=n(60109),f=n(84906);let h=({containerRef:e,id:t,setLoading:n,loading:i})=>{let{processes:{[t]:o}={}}=(0,l.N)(),h=(0,a.A)(),{windowStates:{[t]:m}}=(0,c.w)(),{size:g}=m||{},{componentWindow:y,libs:p,maximized:w}=o||{},{sizes:{titleBar:v}}=(0,s.DP)(),b=(0,f.A)(t,e,void 0,"canvas { height: 100%; width: 100%; }",!0),[C,E]=(0,r.useState)();(0,r.useEffect)(()=>{setTimeout(()=>{let e=g;if(!e&&y){let{height:t,width:n}=y.getBoundingClientRect();e={height:t,width:n}}e&&(C?.CCModule.setCanvasSize?.((0,u.kl)(e.width),(0,u.kl)(e.height)-v.height),C?.CCModule.OnResize?.())},d.UW.WINDOW)},[y,C?.CCModule,w,g,v.height]),(0,r.useEffect)(()=>{if(i){let e=b?.();if(!e)return;let i=e?.document.querySelector("canvas");i.addEventListener("contextmenu",u.CH),e.CCModule={arguments:["Singleplayer"],canvas:i,postRun:[()=>{n(!1),E(e),h(e.FS,t)},()=>{let{width:e,height:t}=i.getBoundingClientRect()||{};i.width=e,i.height=t}],print:console.info,setStatus:console.info,windowElement:e.document.body},(0,u.aY)(p,void 0,void 0,void 0,e)}},[b,t,p,i,h,n])};var m=n(35144);let g=(0,r.memo)(({id:e})=>(0,i.jsx)(m.A,{StyledComponent:o,id:e,useHook:h}))},35144:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(37876),r=n(14232),s=n(77232),o=n(66501),a=n(78011),l=n(81855);let c=s.Ay.div.withConfig({componentId:"sc-e37924df-0"})([""]),d=(0,r.memo)(({id:e,useHook:t,StyledComponent:n,children:s})=>{let{processes:{[e]:{url:d=""}={}}}=(0,l.N)(),u=(0,r.useRef)(null),[f,h]=(0,r.useState)(!0),m=(0,r.useMemo)(()=>({contain:"strict",visibility:f?"hidden":"visible"}),[f]);return t({containerRef:u,id:e,loading:f,setLoading:h,url:d}),(0,i.jsxs)(i.Fragment,{children:[f&&(0,i.jsx)(o.A,{}),(0,i.jsx)(n||c,{ref:u,style:m,...(0,a.A)({id:e}),children:s})]})})},66501:(e,t,n)=>{n.d(t,{A:()=>i});let i=n(77232).Ay.div.withConfig({componentId:"sc-83f4cbe3-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;font-weight:200;justify-content:center;letter-spacing:0.3px;mix-blend-mode:difference;padding-top:',"px;}"],({$hasColumns:e,theme:t})=>e?t.sizes.window.textTopPadding+t.sizes.fileManager.columnHeight:t.sizes.window.textTopPadding)},68667:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(14232),r=n(65231);let s=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,r.f)(),s=(0,i.useRef)("");return(0,i.useEffect)(()=>()=>{if(s.current){let e=s.current;s.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,i.useCallback)(async(t,i)=>{if(!t)return;let r="";try{r=await e(t,i)}catch{}r&&(n("/",r),s.current=r)},[e,n])}},78011:(e,t,n)=>{n.d(t,{A:()=>m});var i=n(79052),r=n(14232),s=n(49697),o=n(84966),a=n(54188),l=n(65231),c=n(81855),d=n(55295),u=n(16361),f=n(60109),h=n(29804);let m=({callback:e,directory:t=u.Bn,id:n,onDragLeave:m,onDragOver:g,updatePositions:y})=>{let{url:p}=(0,c.N)(),w=(0,h.w)(),{iconPositions:v,sortOrders:b,setIconPositions:C}=(0,d.w)(),{exists:E,mkdirRecursive:A,updateFolder:x,writeFile:k}=(0,l.f)(),S=(0,r.useCallback)(async(e,t,r)=>{if(n)if(t){let s=(0,i.join)(u.Bn,e);if(await A(u.Bn),await k(s,t,!0))return r===a.z.UPDATE_URL&&p(n,s),x(u.Bn,e),(0,i.basename)(s)}else r===a.z.UPDATE_URL&&p(n,e);return""},[n,A,x,p,k]),{openTransferDialog:D}=(0,s.A)();return{onDragLeave:m,onDragOver:(0,r.useCallback)(e=>{g?.(e),(0,f.CH)(e)},[g]),onDrop:(0,r.useCallback)(r=>{if(u.jj.has((0,f.uQ)(t)))return;if(r.target instanceof HTMLElement){if(r.target.closest(".focus-within")?.contains(r.target))return;if(y){let{files:e,text:n}=(0,o.bn)(r);if(0===e.length&&""===n)return;(async()=>{let s={x:r.clientX,y:r.clientY},o=[];if(n){try{o=JSON.parse(n)}catch{}if(!Array.isArray(o))return;let[e]=o;if(!e||e.startsWith(t)&&(0,i.basename)(e)===(0,i.relative)(t,e))return;o=o.map(e=>(0,i.basename)(e))}else o=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);o=await (0,f.$I)(o,t,v,E),(0,f.$Y)(t,r.target,v,b,s,o,C,E)})()}}let s="string"==typeof n;s&&!y&&t===u.Bn&&w.current[n]?.componentWindow?.focus(u.VD),(0,o.nX)(r,e||S,t,D,s)},[e,t,E,v,n,D,w,C,b,y,S])}}},84906:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(14232),r=n(78011),s=n(16361),o=n(81855),a=n(55295);let l=(e,t,n,l,c=!1)=>{let[d,u]=(0,i.useState)(),[f,h]=(0,i.useState)(),{onDragOver:m,onDrop:g}=(0,r.A)({id:e}),{processes:{[e]:{maximized:y}={}}={}}=(0,o.N)(),{foregroundId:p,setForegroundId:w}=(0,a.w)(),v=(0,i.useCallback)(()=>{let t;if(!d)return;d.querySelector("iframe")?.remove();let n=((e,t,n)=>{let i=document.createElement("iframe");i.title=e,i.style.backgroundColor="transparent",i.style.border="0",i.style.width="100%",i.style.height="100%",t.append(i);let r=i.contentDocument;r.open(),r.write(`
    <!DOCTYPE html>
    ${n?`<head><style>${n}</style></head>`:"<head />"}
    <body />
    `),r.close();let s=i.contentWindow;return s.document.documentElement.style.height="100%",s.document.documentElement.style.width="100%",s.document.body.style.height="100%",s.document.body.style.width="100%",s.document.body.style.margin="0",s.document.body.style.overflow="hidden",i})(e,d,l),i=n.contentWindow;(e=>{let t=e.HTMLCanvasElement.prototype.getContext;e.HTMLCanvasElement.prototype.getContext=function(e,n){return("webgl"===e||"webgl2"===e)&&(n=Object.assign(n||{},{preserveDrawingBuffer:!0})),t.call(this,e,n)}})(i),c&&(t=(e=>{let t=e.createElement("canvas");return t.id="canvas",t.style.width="100%",t.style.height="100%",t.tabIndex=-1,e.body.append(t),t})(n.contentDocument));let r=()=>{c&&t?t.focus(s.VD):i.focus(),w(e)};return i.addEventListener("click",r),i.addEventListener("focus",r),i.addEventListener("blur",()=>w("")),i.addEventListener("dragover",m),i.addEventListener("drop",g),h(i),i},[d,e,m,g,w,l,c]);return(0,i.useLayoutEffect)(()=>{f&&p===e&&requestAnimationFrame(()=>{n?n(f):c?f.document.querySelector("canvas")?.focus(s.VD):f.focus()})},[f,n,p,e,y,c]),(0,i.useEffect)(()=>{if(!d){let e=()=>{requestAnimationFrame(()=>{t.current?u(t.current):e()})};e()}},[d,t]),(0,i.useMemo)(()=>d?v:void 0,[d,v])}}}]);