"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8819],{28819:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var i=n(37876),r=n(14232),o=n(77232),a=n(68667),s=n(81855),c=n(55295),l=n(16361),u=n(60109),d=n(84906);let f=({containerRef:e,id:t,setLoading:n,loading:i})=>{let{closeWithTransition:f,processes:{[t]:m}={}}=(0,s.N)(),{componentWindow:h,defaultSize:y={height:0,width:0},libs:v=[],maximized:g=!1}=m||{},{windowStates:{[t]:p}}=(0,c.w)(),{sizes:{titleBar:w}}=(0,o.DP)(),b=(0,r.useRef)(!1),A=(0,a.A)(),{size:E}=p||{},q=(0,r.useCallback)(e=>{e?.ioq3?.canvas?e.ioq3.canvas.focus(l.VD):requestAnimationFrame(()=>q(e))},[]),k=(0,d.A)(t,e,q,`
      body { display: flex; place-content: center; place-items: center; }
      canvas { background-color: #000; height: 100%; width: 100%; }
      canvas:focus-visible { outline: none; }
    `),[x,C]=(0,r.useState)();(0,r.useEffect)(()=>{if(i){let e=k?.();e&&(0,u.aY)(v,void 0,void 0,void 0,e).then(()=>{if(!e.ioq3)return;e.ioq3.viewport=e.document.body,e.ioq3.elementPointerLock=!0,e.ioq3.callMain([]),e.console.log=e=>{e.startsWith("SDL_Quit called")&&f(t)},n(!1);let i=()=>{e.ioq3?.canvas?(e.ioq3.canvas.addEventListener("contextmenu",u.CH),C(e),A(e.FS,t)):requestAnimationFrame(i)};i()})}},[f,k,t,v,i,A,n]),(0,r.useEffect)(()=>{x?.ioq3&&setTimeout(()=>{if(!x.ioq3?.canvas)return;b.current=g;let{height:e,width:t}=!g&&E||h?.getBoundingClientRect()||{};if(!e||!t)return;let n=y?(0,u.kl)(y.width)/(0,u.kl)(y.height):4/3,i=(0,u.kl)(t),r=i>(0,u.kl)(e)-w.height,o=g&&r?i/n:i,a=o/n;a>0&&o>0&&(x.ioq3.setCanvasSize(o,a),x.ioq3.canvas.setAttribute("style",`object-fit: ${r?"contain":"scale-down"}`))},g||b.current?l.UW.WINDOW+10:0)},[h,x?.ioq3,y,g,E,w.height]),(0,r.useEffect)(()=>()=>{try{x?.ioq3?.exit()}catch{}x?.AL?.contexts.forEach(({ctx:e})=>e.close())},[x?.AL?.contexts,x?.ioq3])};var m=n(35144);let h=(0,r.memo)(({id:e})=>(0,i.jsx)(m.A,{id:e,useHook:f}))},35144:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(37876),r=n(14232),o=n(77232),a=n(66501),s=n(78011),c=n(81855);let l=o.Ay.div.withConfig({componentId:"sc-e37924df-0"})([""]),u=(0,r.memo)(({id:e,useHook:t,StyledComponent:n,children:o})=>{let{processes:{[e]:{url:u=""}={}}}=(0,c.N)(),d=(0,r.useRef)(null),[f,m]=(0,r.useState)(!0),h=(0,r.useMemo)(()=>({contain:"strict",visibility:f?"hidden":"visible"}),[f]);return t({containerRef:d,id:e,loading:f,setLoading:m,url:u}),(0,i.jsxs)(i.Fragment,{children:[f&&(0,i.jsx)(a.A,{}),(0,i.jsx)(n||l,{ref:d,style:h,...(0,s.A)({id:e}),children:o})]})})},66501:(e,t,n)=>{n.d(t,{A:()=>i});let i=n(77232).Ay.div.withConfig({componentId:"sc-83f4cbe3-0"})(['cursor:wait;height:100%;width:100%;&::before{color:#fff;content:"Working on it...";display:flex;font-size:12px;font-weight:200;justify-content:center;letter-spacing:0.3px;mix-blend-mode:difference;padding-top:',"px;}"],({$hasColumns:e,theme:t})=>e?t.sizes.window.textTopPadding+t.sizes.fileManager.columnHeight:t.sizes.window.textTopPadding)},68667:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(14232),r=n(65231);let o=()=>{let{mountEmscriptenFs:e,unMapFs:t,updateFolder:n}=(0,r.f)(),o=(0,i.useRef)("");return(0,i.useEffect)(()=>()=>{if(o.current){let e=o.current;o.current="",t(e,!0).then(()=>n("/",void 0,e)).catch(()=>{})}},[t,n]),(0,i.useCallback)(async(t,i)=>{if(!t)return;let r="";try{r=await e(t,i)}catch{}r&&(n("/",r),o.current=r)},[e,n])}},78011:(e,t,n)=>{n.d(t,{A:()=>h});var i=n(79052),r=n(14232),o=n(49697),a=n(84966),s=n(54188),c=n(65231),l=n(81855),u=n(55295),d=n(16361),f=n(60109),m=n(29804);let h=({callback:e,directory:t=d.Bn,id:n,onDragLeave:h,onDragOver:y,updatePositions:v})=>{let{url:g}=(0,l.N)(),p=(0,m.w)(),{iconPositions:w,sortOrders:b,setIconPositions:A}=(0,u.w)(),{exists:E,mkdirRecursive:q,updateFolder:k,writeFile:x}=(0,c.f)(),C=(0,r.useCallback)(async(e,t,r)=>{if(n)if(t){let o=(0,i.join)(d.Bn,e);if(await q(d.Bn),await x(o,t,!0))return r===s.z.UPDATE_URL&&g(n,o),k(d.Bn,e),(0,i.basename)(o)}else r===s.z.UPDATE_URL&&g(n,e);return""},[n,q,k,g,x]),{openTransferDialog:L}=(0,o.A)();return{onDragLeave:h,onDragOver:(0,r.useCallback)(e=>{y?.(e),(0,f.CH)(e)},[y]),onDrop:(0,r.useCallback)(r=>{if(d.jj.has((0,f.uQ)(t)))return;if(r.target instanceof HTMLElement){if(r.target.closest(".focus-within")?.contains(r.target))return;if(v){let{files:e,text:n}=(0,a.bn)(r);if(0===e.length&&""===n)return;(async()=>{let o={x:r.clientX,y:r.clientY},a=[];if(n){try{a=JSON.parse(n)}catch{}if(!Array.isArray(a))return;let[e]=a;if(!e||e.startsWith(t)&&(0,i.basename)(e)===(0,i.relative)(t,e))return;a=a.map(e=>(0,i.basename)(e))}else a=e instanceof FileList?[...e].map(e=>e.name):[...e].map(e=>e.getAsFile()?.name||"").filter(Boolean);a=await (0,f.$I)(a,t,w,E),(0,f.$Y)(t,r.target,w,b,o,a,A,E)})()}}let o="string"==typeof n;o&&!v&&t===d.Bn&&p.current[n]?.componentWindow?.focus(d.VD),(0,a.nX)(r,e||C,t,L,o)},[e,t,E,w,n,L,p,A,b,v,C])}}},84906:(e,t,n)=>{n.d(t,{A:()=>c});var i=n(14232),r=n(78011),o=n(16361),a=n(81855),s=n(55295);let c=(e,t,n,c,l=!1)=>{let[u,d]=(0,i.useState)(),[f,m]=(0,i.useState)(),{onDragOver:h,onDrop:y}=(0,r.A)({id:e}),{processes:{[e]:{maximized:v}={}}={}}=(0,a.N)(),{foregroundId:g,setForegroundId:p}=(0,s.w)(),w=(0,i.useCallback)(()=>{let t;if(!u)return;u.querySelector("iframe")?.remove();let n=((e,t,n)=>{let i=document.createElement("iframe");i.title=e,i.style.backgroundColor="transparent",i.style.border="0",i.style.width="100%",i.style.height="100%",t.append(i);let r=i.contentDocument;r.open(),r.write(`
    <!DOCTYPE html>
    ${n?`<head><style>${n}</style></head>`:"<head />"}
    <body />
    `),r.close();let o=i.contentWindow;return o.document.documentElement.style.height="100%",o.document.documentElement.style.width="100%",o.document.body.style.height="100%",o.document.body.style.width="100%",o.document.body.style.margin="0",o.document.body.style.overflow="hidden",i})(e,u,c),i=n.contentWindow;(e=>{let t=e.HTMLCanvasElement.prototype.getContext;e.HTMLCanvasElement.prototype.getContext=function(e,n){return("webgl"===e||"webgl2"===e)&&(n=Object.assign(n||{},{preserveDrawingBuffer:!0})),t.call(this,e,n)}})(i),l&&(t=(e=>{let t=e.createElement("canvas");return t.id="canvas",t.style.width="100%",t.style.height="100%",t.tabIndex=-1,e.body.append(t),t})(n.contentDocument));let r=()=>{l&&t?t.focus(o.VD):i.focus(),p(e)};return i.addEventListener("click",r),i.addEventListener("focus",r),i.addEventListener("blur",()=>p("")),i.addEventListener("dragover",h),i.addEventListener("drop",y),m(i),i},[u,e,h,y,p,c,l]);return(0,i.useLayoutEffect)(()=>{f&&g===e&&requestAnimationFrame(()=>{n?n(f):l?f.document.querySelector("canvas")?.focus(o.VD):f.focus()})},[f,n,g,e,v,l]),(0,i.useEffect)(()=>{if(!u){let e=()=>{requestAnimationFrame(()=>{t.current?d(t.current):e()})};e()}},[u,t]),(0,i.useMemo)(()=>u?w:void 0,[u,w])}}}]);